Описание скрипта синхронизации Jira и GLPI (script.js)
Содержание:
  1.	Общее назначение
  2.	Получение данных из систем
    o	Из Jira
    o	Из GLPI
  3.	Отображение изменений между системами
    o	Из Jira в GLPI
    o	Из GLPI в Jira
  4.	Особенности синхронизации
  5.	Пример работы
  6.	Важные замечания
  7.	Заключение
________________________________________

1. Общее назначение
Скрипт предназначен для двусторонней синхронизации задач между системами Jira и GLPI. Он позволяет:
  •	Переносить задачи из Jira в GLPI и наоборот.
  •	Обновлять существующие задачи при их изменении в одной из систем.
  •	Поддерживать связь между задачами через идентификаторы.
  •	Работать в автоматическом режиме с заданным интервалом или по требованию.
________________________________________

2. Получение данных из систем
Из Jira:
  •	Методы:
    o	getAllJiraIssues(jql) — получает все задачи по JQL-запросу (по умолчанию сортировка по дате создания).
    o	getUpdatedJiraIssues() — получает задачи, измененные после последней синхронизации.
    o	getJiraComments(issueKey) — получает комментарии к задаче.
  •	Поля:
  Используются поля, указанные в config.jira.fieldsToSync: summary, status, assignee, creator, created, updated, comment.
  •	Авторизация:
  Используется базовый доступ (username и password из конфигурации).
  Из GLPI:
  •	Методы:
    o	getAllGlpiTickets(updatedAfter) — получает все тикеты, измененные после указанной даты.
    o	getGlpiTicketDetails(ticketId) — получает полную информацию о тикете, включая комментарии.
  •	Поля:
  Основные поля: id, name, content, status, date_mod.
  Комментарии извлекаются из ITILFollowup.
  •	Авторизация:
  Используются токены (appToken и userToken из конфигурации).
  Для каждого запроса создается и закрывается сессия.
________________________________________

3. Отображение изменений между системами
Из Jira в GLPI:
  1.	Создание тикета в GLPI:
    o	Название: [Ключ задачи Jira]: [Название задачи].
    o	Описание: включает статус, исполнителя, создателя, даты и комментарии из Jira.
    o	Ссылка: добавляется URL задачи в Jira.
  Пример:
  plaintext
  Copy
  Download
  **Задача**: TEST-123  
  **Статус**: В работе  
  **Исполнитель**: Иван Иванов  
  **Содержание**: Описание задачи...  
  2.	Обновление тикета в GLPI:
  Если задача в Jira изменена (например, обновлен статус или добавлен комментарий), соответствующий тикет в GLPI обновляется.
Из GLPI в Jira:
  1.	Создание задачи в Jira:
    o	Название: GLPI-[ID тикета]: [Название тикета].
    o	Описание: включает ID тикета, статус, содержание и комментарии из GLPI.
  Пример:
  plaintext
  Copy
  Download
  Импортировано из GLPI  
  ID: 456  
  Статус: Решен  
  Содержание: Проблема с принтером...  
  2.	Обновление задачи в Jira:
  Если тикет в GLPI изменен, задача в Jira обновляется (например, меняется описание или статус).
________________________________________

4. Особенности синхронизации
  •	Связь задач:
  Скрипт сохраняет соответствие между задачами в файле sync-state.json:
    o	jiraToGlpiMap — сопоставляет ключи Jira с ID тикетов GLPI.
    o	glpiToJiraMap — сопоставляет ID тикетов GLPI с ключами Jira.
  •	Автоматическая синхронизация:
  По умолчанию скрипт запускает синхронизацию каждые 30 минут (syncInterval: '*/30 * * * *').
  •	Режимы работы:
    o	both — двусторонняя синхронизация.
    o	jira-to-glpi — только из Jira в GLPI.
    o	glpi-to-jira — только из GLPI в Jira.
  •	Команды:
    o	sync — запуск синхронизации.
    o	migrate-jira — перенос всех задач из Jira в GLPI.
    o	migrate-glpi — перенос всех тикетов из GLPI в Jira.
________________________________________

5. Пример работы
  1.	Пользователь создает задачу в Jira:
    Скрипт обнаруживает новую задачу при следующей синхронизации.
    В GLPI создается тикет с названием TEST-123: Название задачи и описанием из Jira.
  2.	Пользователь изменяет статус тикета в GLPI:
    Скрипт обнаруживает изменение и обновляет задачу в Jira, добавляя комментарий о смене статуса.
  3.	Пользователь добавляет комментарий в Jira:
    Комментарий появляется в тикете GLPI при следующей синхронизации.
________________________________________

6. Важные замечания
  •	Для корректной работы необходимо проверить настройки в config:
    o	URL и учетные данные для Jira и GLPI.
    o	Ключ проекта и тип задачи в Jira (defaultProjectKey, defaultIssueType).
    o	Соответствие статусов (ticketStatusMap).
  •	Скрипт логирует все действия, что упрощает отладку.
  •	Рекомендуется сначала протестировать синхронизацию вручную (node script.js sync), а затем настроить автоматический режим.
________________________________________

7. Заключение
Скрипт обеспечивает гибкую и надежную синхронизацию задач между Jira и GLPI, сохраняя связь между ними и автоматически обновляя изменения. Это упрощает совместную работу команд, использующих разные системы управления задачами.

